
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2D Finite Volume Meshes &#8212; AEROSP 523 Computational Fluid Dynamics: Code Examples</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Examples/Week10/Meshes';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/scramjet.png" class="logo__image only-light" alt="AEROSP 523 Computational Fluid Dynamics: Code Examples - Home"/>
    <script>document.write(`<img src="../../_static/scramjet.png" class="logo__image only-dark" alt="AEROSP 523 Computational Fluid Dynamics: Code Examples - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    AEROSP 523 Computational Fluid Dynamics: Code Examples
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Content/PythonSetup.html">Getting Started with Python</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1/Week1.html">Week 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1/intro_jax.html">Introduction to JAX</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Week1/RootFinding.html">Root finding methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/homework_1_0.html">Homework 1 - Solution</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week2/Week2.html">Week 2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week2/FiniteDifferences.html">Finite Difference Approximations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week3/Week3.html">Week 3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week3/FiniteDifferenceScheme_bis.html">The Finite Difference Method: 1D steady state heat transfer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week4/Week4.html">Week 4</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week4/IterativeSolvers.html">Iterative linear solvers</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/mariejvaucher/aero523-fall24/main?urlpath=lab/tree/Examples/Week10/Meshes.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mariejvaucher/aero523-fall24" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mariejvaucher/aero523-fall24/issues/new?title=Issue%20on%20page%20%2FExamples/Week10/Meshes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Examples/Week10/Meshes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2D Finite Volume Meshes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-node-coordinates">Part 1: Node coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-node-connectivity">Part 2: Node connectivity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-cell-quantities">Computing cell quantities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cell-connectivity">Cell connectivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-mesh-test-case">Simple mesh test case</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freestream-preservation-test">Freestream preservation test</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="d-finite-volume-meshes">
<h1>2D Finite Volume Meshes<a class="headerlink" href="#d-finite-volume-meshes" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib_inline</span>

<span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;svg&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">niceplots</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">niceplots</span><span class="o">.</span><span class="n">get_style</span><span class="p">())</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">niceplots</span><span class="o">.</span><span class="n">get_colors_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="part-1-node-coordinates">
<h2>Part 1: Node coordinates<a class="headerlink" href="#part-1-node-coordinates" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.node</span></code> files are very simple. Each line contains the x and y coordinate of a node.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodeCoordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;meshes/blade0.node&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-27.000049    -1.237215  ]
 [-27.000049     0.46096024]
 [-27.000049     2.4792453 ]
 [-27.000049     4.87798158]
 [-27.000049     7.728885  ]
 [-23.6831689   -1.237215  ]
 [-23.35562958   0.68898222]
 [-22.96704546   2.97778661]
 [-22.50590944   5.69755045]
 [-21.95854535   8.92951054]]
</pre></div>
</div>
</div>
</div>
<p>These nodes be plotted very simply using the standard <code class="docutils literal notranslate"><span class="pre">plot</span></code> function from matplotlib.
Just be sure to turn off the line connecting the points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Nodes&quot;</span><span class="p">)</span>
<span class="n">niceplots</span><span class="o">.</span><span class="n">adjust_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3cbc407bd7306545d048322f42658213cc553b60f390674419727582f5b70c5f.svg" src="../../_images/3cbc407bd7306545d048322f42658213cc553b60f390674419727582f5b70c5f.svg" />
</div>
</div>
</section>
<section id="part-2-node-connectivity">
<h2>Part 2: Node connectivity<a class="headerlink" href="#part-2-node-connectivity" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.elem</span></code> file describes how the nodes are connected to form the triangular cells.
Each row in the file contains the indices of the three nodes that form a triangle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MAKE SURE TO SUBTRACT 1 FROM THE ELEMENT CONNECTIVITY BECAUSE PYTHON IS 0 INDEXED</span>
<span class="n">nodeConnectivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;meshes/blade0.elem&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nodeConnectivity</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0  5  1]
 [ 5  6  1]
 [ 1  6  2]
 [ 6  7  2]
 [ 2  7  3]
 [ 7  8  3]
 [ 3  8  4]
 [ 8  9  4]
 [ 5 10  6]
 [10 11  6]]
</pre></div>
</div>
</div>
</div>
<p>We can use this information to plot the mesh cells.</p>
<p>The naive way to do this would be to loop through each cell, then loop through each node in the cell and plot a line from that node to the next node in the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Naive plotting method</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">cellNum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">edgeNum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">node1</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[</span><span class="n">cellNum</span><span class="p">,</span> <span class="n">edgeNum</span><span class="p">]</span>
        <span class="n">node2</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[</span><span class="n">cellNum</span><span class="p">,</span> <span class="p">(</span><span class="n">edgeNum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="p">[</span><span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
            <span class="p">[</span><span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">niceplots</span><span class="o">.</span><span class="n">adjust_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ba1aaf2b2dfec463ef9a328e32b110f887439eac25a4b5912730d199124f4d03.svg" src="../../_images/ba1aaf2b2dfec463ef9a328e32b110f887439eac25a4b5912730d199124f4d03.svg" />
</div>
</div>
<p>Fortunately, matplotlib has a function that automates this process: <code class="docutils literal notranslate"><span class="pre">triplot</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">triplot</span></code> takes in arrays of x and y coordinates, followed by another argument that describes the node connectivity, such as our node connectivity array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Smarter plotting method</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nodeConnectivity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">niceplots</span><span class="o">.</span><span class="n">adjust_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/171a8c6ad64ce89ac843bf12bb3e633146109acf7c4a46dc77899d7cb2bde85e.svg" src="../../_images/171a8c6ad64ce89ac843bf12bb3e633146109acf7c4a46dc77899d7cb2bde85e.svg" />
</div>
</div>
<section id="computing-cell-quantities">
<h3>Computing cell quantities<a class="headerlink" href="#computing-cell-quantities" title="Link to this heading">#</a></h3>
<p>Often, we want to plot some quantity that is defined on the cells, such as the Mach number or density.
Matplotlib has another function called <code class="docutils literal notranslate"><span class="pre">tripcolor</span></code> that can be used to plot such quantities.
<code class="docutils literal notranslate"><span class="pre">tripcolor</span></code> takes in the same arguments as <code class="docutils literal notranslate"><span class="pre">triplot</span></code>, but also takes in an array of values that are defined on the cells or nodes.</p>
<p>The code below demonstrates <code class="docutils literal notranslate"><span class="pre">tripcolor</span></code> by plotting the cell areas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeCellAreas</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">):</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cellAreas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numCells</span><span class="p">)</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">node2</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">node3</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">cellAreas</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y3</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">*</span> <span class="p">(</span><span class="n">y3</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">cellAreas</span>


<span class="n">cellAreas</span> <span class="o">=</span> <span class="n">computeCellAreas</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nodeConnectivity</span><span class="p">,</span> <span class="n">cellAreas</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">niceplots</span><span class="o">.</span><span class="n">adjust_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/807701e05f5f4596d0149dc709337ea38f5bd8d4129c220150f5d6bfaa896dc2.svg" src="../../_images/807701e05f5f4596d0149dc709337ea38f5bd8d4129c220150f5d6bfaa896dc2.svg" />
</div>
</div>
<p>We can then call other plotting methods to plot other things on top of the mesh, such as the cell edges.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nodeConnectivity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/df27cd86163241f857c5fb8c85110037e24aae1ee4a0e0e3c2ffb2869161fe84.svg" src="../../_images/df27cd86163241f857c5fb8c85110037e24aae1ee4a0e0e3c2ffb2869161fe84.svg" />
</div>
</div>
</section>
</section>
<section id="cell-connectivity">
<h2>Cell connectivity<a class="headerlink" href="#cell-connectivity" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.connect</span></code> file describes how the cells in the mesh are connected to each other.
Each row in the file contains the 3 indices of the neighbouring cells.
A negative index indicates that an edge is on the boundary of the domain, and the value of the negative number denotes the type of boundary condition.</p>
<p>The ordering of the neighbouring cell indices is linked to the ordering of the nodes in each cell.
The first neighbouring cell index corresponds to the neighbour on the edge of the triangle opposite the first node in the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cellConnectivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;meshes/blade0.connect&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># Subtract 1 from the cell connectivity because Python is 0 indexed, but not for the negative values that represent the boundary conditions</span>
<span class="n">cellConnectivity</span><span class="p">[</span><span class="n">cellConnectivity</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use the cell connectivity information to plot lines between a few of the cells and their neighbours.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeCellCentroids</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">):</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cellCentroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">numCells</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">node2</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">node3</span> <span class="o">=</span> <span class="n">nodeConnectivity</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">node3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">cellCentroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="n">cellCentroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">y3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="k">return</span> <span class="n">cellCentroids</span>


<span class="n">cellCentroids</span> <span class="o">=</span> <span class="n">computeCellCentroids</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># Choose a random cell index and get that cell&#39;s centroid</span>
    <span class="n">cellIndex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cellConnectivity</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">centroid</span> <span class="o">=</span> <span class="n">cellCentroids</span><span class="p">[</span><span class="n">cellIndex</span><span class="p">]</span>
    <span class="c1"># Plot a line between the centroid of this cell and the centroid of each of its neighbors, excluding boundaries.</span>
    <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">neighborIndex</span> <span class="o">=</span> <span class="n">cellConnectivity</span><span class="p">[</span><span class="n">cellIndex</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">neighborIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">neighborCentroid</span> <span class="o">=</span> <span class="n">cellCentroids</span><span class="p">[</span><span class="n">neighborIndex</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">neighborCentroid</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">neighborCentroid</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;r-o&quot;</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/97e9a731d328a46e38a89ee2991395bb5367574801be53fd7456fc8eb022118b.svg" src="../../_images/97e9a731d328a46e38a89ee2991395bb5367574801be53fd7456fc8eb022118b.svg" />
</div>
</div>
</section>
<section id="simple-mesh-test-case">
<h2>Simple mesh test case<a class="headerlink" href="#simple-mesh-test-case" title="Link to this heading">#</a></h2>
<p>When you write your mesh processing code, it’s a good idea to come up with a simple test case that you can use to verify that your code is working correctly.</p>
<p>Here we construct such a case using 4 nodes and 2 triangles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodeCoordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">nodeConnectivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>

<span class="n">cellAreas</span> <span class="o">=</span> <span class="n">computeCellAreas</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">)</span>
<span class="n">cellCentroids</span> <span class="o">=</span> <span class="n">computeCellCentroids</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nodeConnectivity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Label the nodes with their indices</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span> <span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

<span class="c1"># Label the cells with their indices</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cellCentroids</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span> <span class="p">(</span><span class="n">cellCentroids</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cellCentroids</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

<span class="n">niceplots</span><span class="o">.</span><span class="n">adjust_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/91b77bb86b4c5a17e4c46baeba9423abb2b65117b7843950e905d44f7bf24e42.svg" src="../../_images/91b77bb86b4c5a17e4c46baeba9423abb2b65117b7843950e905d44f7bf24e42.svg" />
</div>
</div>
<p>To compute fluxes, we need data about the edges in the mesh.</p>
<p>It is useful to split the edges into two sets; interior edges and boundary edges.</p>
<p>Interior edges are those that are shared by two cells, while boundary edges are only part of one cell, because they lie on the boundary of the domain.</p>
<p>Here I am manually creating the data structures that describe the edges, in your project you will need to write code to do this for any mesh.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># each row in this array contains, the indices of the nodes that make up the edge, followed by the index of the left cell and the index of the right cell</span>
<span class="c1"># [startNode, endNode, leftCell, rightCell]</span>
<span class="n">interiorEdges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Each row in the boundary edges array contains the indices of the nodes that make up the edge, followed by the index of the cell that the edge is on and finally the boundary condition type</span>
<span class="c1"># [startNode, endNode, (left)Cell, boundaryConditionType]</span>
<span class="n">boundaryEdges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">interiorEdges</span><span class="p">):</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">node2</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">centroid</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">node1</span> <span class="o">+</span> <span class="n">node2</span><span class="p">)</span>
    <span class="n">edgeVector</span> <span class="o">=</span> <span class="n">node2</span> <span class="o">-</span> <span class="n">node1</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">edgeVector</span><span class="p">)</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">edgeVector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">edgeVector</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">/</span> <span class="n">edgeLength</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span>
        <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">normal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">normal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">head_width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">head_length</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boundaryEdges</span><span class="p">):</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">node2</span> <span class="o">=</span> <span class="n">nodeCoordinates</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">centroid</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">node1</span> <span class="o">+</span> <span class="n">node2</span><span class="p">)</span>
    <span class="n">edgeVector</span> <span class="o">=</span> <span class="n">node2</span> <span class="o">-</span> <span class="n">node1</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">edgeVector</span><span class="p">)</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">edgeVector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">edgeVector</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">/</span> <span class="n">edgeLength</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span>
        <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">normal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">normal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">head_width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">head_length</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span>
        <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7c59a8012dcd76178de8c8d62724e1e5a1b036bd3f66ad14ee76f72fe8addcc2.svg" src="../../_images/7c59a8012dcd76178de8c8d62724e1e5a1b036bd3f66ad14ee76f72fe8addcc2.svg" />
</div>
</div>
<section id="freestream-preservation-test">
<h3>Freestream preservation test<a class="headerlink" href="#freestream-preservation-test" title="Link to this heading">#</a></h3>
<p>The freestream presentation test works by setting all the boundary conditions and cell states to be equal to a freestream state.</p>
<p>We then check 2 things:</p>
<ul class="simple">
<li><p>The initial residual should be zero</p></li>
<li><p>The residual should remain at zero (and the cell states remain at the freestream) as we march forward in time</p></li>
</ul>
<p>Here we perform these tests in a very hardcoded way, your project code will be able to do the same thing in a much more general way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flux</span> <span class="kn">import</span> <span class="n">FluxFunction</span>

<span class="n">cellPerimeter</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">computeTestCaseResidual</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">U1</span><span class="p">,</span> <span class="n">UBoundary</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">waveSpeeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Left Boundary</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">smag</span> <span class="o">=</span> <span class="n">FluxFunction</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">UBoundary</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">edgeLength</span>
    <span class="n">waveSpeeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smag</span> <span class="o">*</span> <span class="n">edgeLength</span> <span class="o">/</span> <span class="n">cellPerimeter</span>

    <span class="c1"># Bottom Boundary</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">smag</span> <span class="o">=</span> <span class="n">FluxFunction</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">UBoundary</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">edgeLength</span>
    <span class="n">waveSpeeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smag</span> <span class="o">*</span> <span class="n">edgeLength</span> <span class="o">/</span> <span class="n">cellPerimeter</span>

    <span class="c1"># Right Boundary</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">smag</span> <span class="o">=</span> <span class="n">FluxFunction</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">UBoundary</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">edgeLength</span>
    <span class="n">waveSpeeds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smag</span> <span class="o">*</span> <span class="n">edgeLength</span> <span class="o">/</span> <span class="n">cellPerimeter</span>

    <span class="c1"># Top Boundary</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">smag</span> <span class="o">=</span> <span class="n">FluxFunction</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">UBoundary</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">edgeLength</span>
    <span class="n">waveSpeeds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smag</span> <span class="o">*</span> <span class="n">edgeLength</span> <span class="o">/</span> <span class="n">cellPerimeter</span>

    <span class="c1"># Interior edge</span>
    <span class="n">edgeLength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ndiag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">smag</span> <span class="o">=</span> <span class="n">FluxFunction</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">U1</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">ndiag</span><span class="p">)</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">edgeLength</span>
    <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">edgeLength</span>
    <span class="n">waveSpeeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smag</span> <span class="o">*</span> <span class="n">edgeLength</span> <span class="o">/</span> <span class="n">cellPerimeter</span>
    <span class="n">waveSpeeds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">smag</span> <span class="o">*</span> <span class="n">edgeLength</span> <span class="o">/</span> <span class="n">cellPerimeter</span>

    <span class="k">return</span> <span class="n">R</span><span class="p">,</span> <span class="n">waveSpeeds</span>
</pre></div>
</div>
</div>
</div>
<p>For the first freestream preservation test, we make up a freestream state, set it in both cells, and then check that the residual is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freeStreamState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">])</span>

<span class="n">U0</span> <span class="o">=</span> <span class="n">freeStreamState</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">U1</span> <span class="o">=</span> <span class="n">freeStreamState</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>

<span class="n">R</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">computeTestCaseResidual</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">U1</span><span class="p">,</span> <span class="n">freeStreamState</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.00000000e+00 -2.22044605e-16  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  2.22044605e-16  0.00000000e+00  0.00000000e+00]]
</pre></div>
</div>
</div>
</div>
<p>And now we will run a simulation for a few thousand timesteps, and check that the residual remains zero and the state doesn’t significantly change.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numTimeSteps</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">CFL</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">cellDiameter</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">cellAreas</span> <span class="o">=</span> <span class="n">computeCellAreas</span><span class="p">(</span><span class="n">nodeCoordinates</span><span class="p">,</span> <span class="n">nodeConnectivity</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numTimeSteps</span><span class="p">):</span>
    <span class="n">R</span><span class="p">,</span> <span class="n">waveSpeeds</span> <span class="o">=</span> <span class="n">computeTestCaseResidual</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">U1</span><span class="p">,</span> <span class="n">freeStreamState</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">CFL</span> <span class="o">*</span> <span class="n">cellDiameter</span> <span class="o">/</span> <span class="n">waveSpeeds</span>

    <span class="n">U0</span> <span class="o">-=</span> <span class="n">dt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">cellAreas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">U1</span> <span class="o">-=</span> <span class="n">dt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">cellAreas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial state = </span><span class="si">{</span><span class="n">freeStreamState</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final states:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U0 = </span><span class="si">{</span><span class="n">U0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U1 = </span><span class="si">{</span><span class="n">U1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final Residuals:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial state = [0.5 0.4 0.8 2.6]
Final states:
U0 = [0.5 0.4 0.8 2.6]
U1 = [0.5 0.4 0.8 2.6]
Final Residuals:
[[ 0.00000000e+00  2.22044605e-16  0.00000000e+00  0.00000000e+00]
 [-2.22044605e-16 -4.44089210e-16  0.00000000e+00 -8.88178420e-16]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mariejvaucher/aero523-fall24",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Examples/Week10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-node-coordinates">Part 1: Node coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-node-connectivity">Part 2: Node connectivity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-cell-quantities">Computing cell quantities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cell-connectivity">Cell connectivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-mesh-test-case">Simple mesh test case</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freestream-preservation-test">Freestream preservation test</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alasdair Christison Gray
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>